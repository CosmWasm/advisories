# CWA-2025-007: Unbounded reply recursion causing stack overflow

**Severity**

Medium (Moderate + Possible)[^1]

**Affected versions:**

- wasmd ≤`v0.61.5`, ≤`v0.60.1`, ≤`v0.54.2`

**Patched versions:**

- wasmd `v0.61.6`, `v0.60.2`, `v0.54.3` 

## Description of the bug

A flaw in the reply handling logic allowed a contract to recursively trigger submessages from within
its own reply handler without proper depth limitation. This could lead to unbounded recursion
and eventually a stack overflow in the wasmd process, causing the node to crash.
The issue does not directly lead to fund loss, but under certain conditions it could result
in validator crashes and potential chain halt.

## Patch

The fix ensures that reply-triggered submessage execution is properly protected by call depth limits,
preventing unbounded recursion that could lead to stack overflow.

## Applying the patch

Chains MUST upgrade **wasmd** to one of the patched versions:
- `v0.61.6`
- `v0.60.2`
- `v0.54.3`

This is a consensus-breaking patch release and therefore requires a coordinated chain upgrade.
Networks must coordinate and deploy the patched binary accordingly.

## Acknowledgement

We thank the [reporter] for responsibly disclosing this issue.

[reporter]: https://immunefi.com/profile/MajorExcitement/ 

## Timeline

- 2025-10-10: HadronLabs was informed about this vulnerability.
- 2025-10-25: HadronLabs developed the patch internally.
- 2025-10-31: Upcoming patch was announced.
- 2025-11-05: Patch has been released.

[^1]: Following Amulet's [Severity Classification Framework ACMv1.2].

[Severity Classification Framework ACMv1.2]: https://github.com/interchainio/security/blob/0295254e8645301ccb606d46108a45cede0a73e0/resources/CLASSIFICATION_MATRIX.md
